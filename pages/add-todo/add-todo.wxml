<view wx:if="{{isVoiceMode}}" class="voice-tip">
  <image src="../../images/todo-active.png" class="voice-icon"/>
  <text class="tip-text">已通过语音输入待办内容，请继续编辑其他信息</text>
</view>

<view class="container">
  <view class="form-container">
    <!-- 问题式表单项 -->
    <view class="form-item">
      <text class="question-title">待办事项内容</text>
      <t-input 
        style="--td-input-bg-color: #f8f8f8" 
        placeholder="请输入待办内容" 
        value="{{inputValue}}" 
        borderless 
        bind:change="handleInputChange"
        data-field="inputValue"
      />
    </view>

    <!-- 替换原有日期选择器 -->
    <view class="form-item">
      <text class="question-title">日期</text>
      <view class="picker-field" bindtap="showCalendar">
        <text>{{setDate || '请选择日期'}}</text>
        <t-icon name="calendar"></t-icon>
      </view>
    </view>

    <view class="form-item">
      <text class="question-title">时间</text>
      <picker 
        mode="time" 
        value="{{setTime}}" 
        bindchange="bindTimeChange">
        <view class="picker-field">
          {{setTime || '请选择时间'}}
        </view>
      </picker>
    </view>

    <t-calendar
      id="calendar"
      value="{{value}}"
      visible="{{showCalendar}}"
      min-date="{{minDate}}"
      max-date="{{maxDate}}"
      format="{{format}}"
      confirm-btn="确定"
      bind:confirm="handleCalendarConfirm"
      bind:close="handleCalendarClose"
    />

    <view class="form-item">
      <text class="question-title">位置（选填）</text>
      <view class="picker-field" bindtap="chooseLocation">
        {{location ? location.name + ' - ' + location.address : '点击选择位置'}}
      </view>
    </view>

    <view class="form-item">
      <text class="question-title">备注（选填）</text>
      <t-textarea
        placeholder="可在此添加备注信息"
        value="{{remarks}}"
        bind:change="handleRemarksChange"
        bordered="{{false}}"
        maxlength="999"
        disableDefaultPadding="{{true}}"
        indicator
        style="--td-textarea-background-color:#f8f8f8"
      />
    </view>
  </view>
</view>

<t-fab icon="check" text="完成" bindclick="addTodo"/>